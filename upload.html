<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="styles/styles.css" />
    <title>Plantify - Upload Image</title>
  </head>
  <body>
    <header>
      <h1>Plantify</h1>
      <p>A place to identify plant diseases and find remedies</p>
    </header>

    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="upload.html">Upload Image</a></li>
        <li><a href="result.html">Result</a></li>
        <li><a href="explore.html">Explore Products</a></li>
      </ul>
    </nav>

    <main>
      <section id="upload-section" class="container">
        <h2>Upload Image</h2>
        <p>
          Select the type of plant and upload an image to identify diseases:
        </p>
        <form id="upload-form" enctype="multipart/form-data">
          <!-- Hidden input to store the selected plant type -->
          <input type="hidden" name="plant-type" id="plant-type-input" />

          <div class="row">
            <div class="col-md-3">
              <div class="plant-option" onclick="showPlantImage('cashew')">
                <label>
                  <input
                    type="radio"
                    name="plant-type-radio"
                    value="cashew"
                    onclick="setSelectedPlant('cashew')"
                  />
                  <div class="image-container">
                    <img src="images/cashew.jpeg" alt="Cashew" />
                  </div>
                  <p>Cashew</p>
                </label>
              </div>
            </div>
            <!-- Repeat for other plant options -->
            <div class="col-md-3">
              <div class="plant-option" onclick="showPlantImage('cassava')">
                <label>
                  <input
                    type="radio"
                    name="plant-type-radio"
                    value="cassava"
                    onclick="setSelectedPlant('cassava')"
                  />
                  <div class="image-container">
                    <img src="images/cassava.jpeg" alt="cassava" />
                  </div>
                  <p>cassava</p>
                </label>
              </div>
            </div>
            <div class="col-md-3">
              <div class="plant-option" onclick="showPlantImage('tomato')">
                <label>
                  <input
                    type="radio"
                    name="plant-type-radio"
                    value="tomato"
                    onclick="setSelectedPlant('tomato')"
                  />
                  <div class="image-container">
                    <img src="images/tomato.jpeg" alt="tomato" />
                  </div>
                  <p>tomato</p>
                </label>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="plant-option" onclick="showPlantImage('maize')">
              <label>
                <input
                  type="radio"
                  name="plant-type-radio"
                  value="maize"
                  onclick="setSelectedPlant('maize')"
                />
                <div class="image-container">
                  <img src="images/maize.jpeg" alt="maize" />
                </div>
                <p>maize</p>
              </label>
            </div>
          </div>
          <div class="form-group">
            <label for="image-input">Upload Image:</label>
            <input
              type="file"
              class="form-control-file"
              accept="image/*"
              id="image-input"
              name="image"
              required
            />
          </div>
          <button type="button" class="btn btn-primary" onclick="submitForm()">
            Upload
          </button>
        </form>
      </section>
    </main>

    <footer>
      <p>&copy; 2023 Plantify</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
      // Function to display the selected plant image
      function showPlantImage(plantType) {
        const imageContainer = document.getElementById("selected-plant-image");
        const imagePath = `images/${plantType}.jpeg`; // Assuming images are named after plant types
        imageContainer.innerHTML = `<img src="${imagePath}" alt="${plantType}">`;

        // Set the selected plant type in the hidden input field
        document.getElementById("plant-type-input").value = plantType;
      }

      // Function to set the selected plant type when the radio button is clicked
      function setSelectedPlant(plantType) {
        document.getElementById("plant-type-input").value = plantType;
      }

      // Function to submit the form
      // Function to submit the form
      function submitForm() {
        const selectedPlant = document.getElementById("plant-type-input").value;
        const selectedImage = document.getElementById("image-input").files[0];

        if (selectedPlant && selectedImage) {
          // Create a FormData object to send the data as a multipart/form-data
          const formData = new FormData();
          formData.append("plant_type", selectedPlant);
          formData.append("image", selectedImage);

          // Make a POST request to the Flask backend using fetch
          fetch("http://localhost:3000/upload", {
            method: "POST",
            body: formData,
          })
            .then((response) => response.json())
            .then((data) => {
              // Handle the response from the backend
              console.log("Response from backend:", data);

              // Optionally, you can redirect to the result page or perform other actions
            })
            .catch((error) => {
              console.error("Error communicating with the backend:", error);
            });
        } else {
          alert("Please select a plant type and upload an image.");
        }
      }
    </script>
  </body>
</html>
